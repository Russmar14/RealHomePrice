---
title: "RealHomePrice"
output: html_document
date: "2022-11-21"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
install.packages("caTools")
```


```{r loading packages}
library(SingleR)
library(dplyr)
library(SeuratObject)
library(Seurat)
library(singlet)
library(dplyr)
library(ggplot2)
library(RcppML)
library(broom)
library(caTools)
```
```{r}
realtor_data <- read.csv("realtor-data.csv")
```

```{r selecting required columns}
realtor_data1 <- realtor_data %>%
  select(c('price','bed','bath','acre_lot','house_size'))

realtor_data1
```

```{r  removing rows with null values}

cleaned_realtordata <- na.omit(realtor_data1)



index <- sample(1:nrow(cleaned_realtordata), round(0.75*nrow(cleaned_realtordata)))
```


```{r Normalization and Splitting data}

min <- apply(cleaned_realtordata, 2, min)
max <- apply(cleaned_realtordata, 2, max)
Scaled_data <- as.data.frame(scale(user_data, center = min, scale = max - min))

train_data_lm <- Scaled_data[index,]
test_data_lm <- Scaled_data[-index,]





```




```{r Getting Linear model setup}


linear_model_fit <- lm(price~bed+bath+acre_lot+house_size, data = train_data_lm)
#quick summary of our model
summary(linear_model_fit)
#using tidy() to create a tibble of coefficients to use for neural network weights later
weights_table <- tidy(linear_model_fit)

```





```{r User input}
{
    bed = as.integer(readline("Enter bed : "));
    bath = as.integer(readline("Enter bath : "));
    acre_lot = as.numeric(readline("Enter acre_lot : "));
    house_size = as.integer(readline("Enter house_size: "));
}

user_data = data.frame(bed, bath, acre_lot, house_size)

```


```{r}
min <- apply(user_data, 2, min)
max <- apply(user_data, 2, max)
Scaled_user_data <- as.data.frame(scale(user_data, center = min, scale = max - min))




```


```{r Using a function}

predict_func <- function(user_data) {
  predict(linear_model_fit, user_data)
}

```

```{r}
predict_func(user_data)
```


```{r Install neural net package and setup}

install.packages("neuralnet")

```


```{r Library Neural net}

library(neuralnet)


nn <- neuralnet::neuralnet(linear_model_fit, data = train_data, linear.output = TRUE)



```

```{r Looking at our work}

plot(nn)

```

```{r Using the nerual net}


pr.nn <- compute(nn,test_data[,1:5])
pr.nn_ <- pr.nn$net.result*(max(test_data$price)-min(test_data$price))+min(test_data$price)
test.r <- (test_data$price)*(max(test_data$price)-min(test_data$price))+min(test_data$price)
MSE.nn <- sum((test.r - pr.nn_)^2)/nrow(test_data)

```


```{r}

compute(pr.nn_, user_data)

```

